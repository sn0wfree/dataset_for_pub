library(survival)
Art<-subset(testdata,testdata['category']=='Art')     
Comics<-subset(testdata,testdata['category']== 'Comics')
Crafts<-subset(testdata,testdata['category']== 'Crafts')
Dance<-subset(testdata,testdata['category']== 'Dance')
Design<-subset(testdata,testdata['category']== 'Design')
Fashion<-subset(testdata,testdata['category']== 'Fashion')
FilmandVideo<-subset(testdata,testdata['category']== 'Film&Video')        
Food<-subset(testdata,testdata['category']== 'Food')     
Games<-subset(testdata,testdata['category']== 'Games') 
Journalism<-subset(testdata,testdata['category']== 'Journalism')       
Music<-subset(testdata,testdata['category']== 'Music')
Photography<-subset(testdata,testdata['category']== 'Photography')
Publishing<-subset(testdata,testdata['category']== 'Publishing')  
Technology<-subset(testdata,testdata['category']== 'Technology')     
Theater<-subset(testdata,testdata['category']== 'Theater')

category_group<-c(Art,Comics,Crafts,Dance,Design,Fashion,FilmandVideo,Food,Games,Journalism,Music,Photography,Publishing,Technology,Theater) 
category<-c('Art','Comics','Crafts','Dance','Design','Fashion','FilmandVideo','Food','Games','Journalism','Music','Photography','Publishing','Technology','Theater') 





hazardstest<-coxph(Surv(projectstatecode,SURVIVALDAY)~
                     + firsttwodaypledgedrate+goalusd
                   + backercounts+HasavideoDummy
                   + commits
                   + update
                   + friends,data=hazardsdata)

surdataset<-Surv(testdata$SURVIVALDAY,testdata$SUCCESS==1)


#sink("/Users/sn0wfree/Dropbox/BitTorrentSync/kickstarter_dataset/data/empirical_test_data/hazards/coxsurvivaldistribution.txt")

surArt<-Surv(Art$SURVIVALDAY,Art$SUCCESS==1)
surComics<-Surv(Comics$SURVIVALDAY,Comics$SUCCESS==1)
surCrafts<-Surv(Crafts$SURVIVALDAY,Crafts$SUCCESS==1)
surDance<-Surv(Dance$SURVIVALDAY,Dance$SUCCESS==1)
surDesign<-Surv(Design$SURVIVALDAY,Design$SUCCESS==1)
surFashion<-Surv(Fashion$SURVIVALDAY,Fashion$SUCCESS==1)
surFilmandVideo<-Surv(FilmandVideo$SURVIVALDAY,FilmandVideo$SUCCESS==1)
surFood<-Surv(Food$SURVIVALDAY,Food$SUCCESS==1)
surGames<-Surv(Games$SURVIVALDAY,Games$SUCCESS==1)
surJournalism<-Surv(Journalism$SURVIVALDAY,Journalism$SUCCESS==1)
surMusic<-Surv(Music$SURVIVALDAY,Music$SUCCESS==1)
surPhotography<-Surv(Photography$SURVIVALDAY,Photography$SUCCESS==1)
surPublishing<-Surv(Publishing$SURVIVALDAY,Publishing$SUCCESS==1)
surTechnology<-Surv(Technology$SURVIVALDAY,Technology$SUCCESS==1)
surTheater<-Surv(Theater$SURVIVALDAY,Theater$SUCCESS==1)

kmfit14Art <- survfit(surArt~Art$FTDPR14_d)
kmfit14Comics <- survfit(surComics~Comics$FTDPR14_d)
kmfit14Crafts <- survfit(surCrafts~Crafts$FTDPR14_d)
kmfit14Dance <- survfit(surDance~Dance$FTDPR14_d)
kmfit14Design <- survfit(surDesign~Design$FTDPR14_d)
kmfit14Fashion <- survfit(surFashion~Fashion$FTDPR14_d)
kmfit14FilmandVideo <- survfit(surFilmandVideo~FilmandVideo$FTDPR14_d)
kmfit14Food <- survfit(surFood~Food$FTDPR14_d)
kmfit14Games <- survfit(surGames~Games$FTDPR14_d)
kmfit14Journalism <- survfit(surJournalism~Journalism$FTDPR14_d)
kmfit14Music <- survfit(surMusic~Music$FTDPR14_d)
kmfit14Photography <- survfit(surPhotography~Photography$FTDPR14_d)
kmfit14Publishing <- survfit(surPublishing~Publishing$FTDPR14_d)
kmfit14Technology <- survfit(surTechnology~Technology$FTDPR14_d)
kmfit14Theater <- survfit(surTheater~Theater$FTDPR14_d)

sink("/Users/sn0wfree/Dropbox/BitTorrentSync/kickstarter_dataset/data/empirical_test_data/hazards/coxsubsamplesurvivaldistribution.csv")
summary(kmfit14Art)
summary(kmfit14Comics)
summary(kmfit14Crafts)
summary(kmfit14Dance)
summary(kmfit14Design)
summary(kmfit14Fashion)
summary(kmfit14FilmandVideo)
summary(kmfit14Food)
summary(kmfit14Games)
summary(kmfit14Journalism)
summary(kmfit14Music)
summary(kmfit14Photography)
summary(kmfit14Publishing)
summary(kmfit14Technology)
summary(kmfit14Theater)
sink()
  #combin with n*m:par(mfrow=c(n,m))
par(mfrow=c(3,5))
plot(kmfit14Art,lty = c('solid', 'dashed'), main= 'Art model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
#legend('bottomleft', c('FTDPR14_d=0','FTDPR14_d=1'), lty=c('solid','dashed'),col=c('red','blue'))
plot(kmfit14Comics,lty = c('solid', 'dashed'), main= 'Comics model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Crafts,lty = c('solid', 'dashed'), main= 'Crafts model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Dance,lty = c('solid', 'dashed'), main= 'Dance model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Design,lty = c('solid', 'dashed'), main= 'Design model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Fashion,lty = c('solid', 'dashed'), main= 'Fashion model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14FilmandVideo,lty = c('solid', 'dashed'), main= 'FilmandVideo model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Food,lty = c('solid', 'dashed'), main= 'Food model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Games,lty = c('solid', 'dashed'), main= 'Games model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Journalism,lty = c('solid', 'dashed'), main= 'Journalism model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Music,lty = c('solid', 'dashed'), main= 'Music model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Photography,lty = c('solid', 'dashed'), main= 'Photography model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Publishing,lty = c('solid', 'dashed'), main= 'Publishing model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Technology,lty = c('solid', 'dashed'), main= 'Technology model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Theater,lty = c('solid', 'dashed'), main= 'Theater model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')

survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Art)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Comics)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Crafts)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Dance)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Design)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Fashion)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=FilmandVideo)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Food)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Games)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Journalism)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Music)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Photography)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Publishing)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Technology)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Theater)

survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Art)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Comics)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Crafts)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Dance)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Design)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Fashion)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=FilmandVideo)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Food)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Games)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Journalism)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Music)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Photography)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Publishing)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Technology)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d+strata(UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS), data=Theater)

coxmodel14Art <- coxph(surArt~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Art)
coxmodel14Comics <- coxph(surComics~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Comics)
coxmodel14Crafts <- coxph(surCrafts~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Crafts)
coxmodel14Dance <- coxph(surDance~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Dance)
coxmodel14Design <- coxph(surDesign~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Design)
coxmodel14Fashion <- coxph(surFashion~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Fashion)
coxmodel14FilmandVideo <- coxph(surFilmandVideo~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=FilmandVideo)
coxmodel14Food <- coxph(surFood~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Food)
coxmodel14Games <- coxph(surGames~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Games)
coxmodel14Journalism <- coxph(surJournalism~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Journalism)
coxmodel14Music <- coxph(surMusic~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Music)
coxmodel14Photography <- coxph(surPhotography~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Photography)
coxmodel14Publishing <- coxph(surPublishing~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Publishing)
coxmodel14Technology <- coxph(surTechnology~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Technology)
coxmodel14Theater <- coxph(surTheater~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Theater)


sink("/Users/sn0wfree/Dropbox/BitTorrentSync/kickstarter_dataset/data/empirical_test_data/hazards/coxmodelcategoyrresult.txt")
summary(coxmodel14Art)
summary(coxmodel14Comics)
summary(coxmodel14Crafts)
summary(coxmodel14Dance)
summary(coxmodel14Design)
summary(coxmodel14Fashion)
summary(coxmodel14FilmandVideo)
summary(coxmodel14Food)
summary(coxmodel14Games)
summary(coxmodel14Journalism)
summary(coxmodel14Music)
summary(coxmodel14Photography)
summary(coxmodel14Publishing)
summary(coxmodel14Technology)
summary(coxmodel14Theater)
sink()
(res.zph14Art <- cox.zph(coxmodel14Art))
(res.zph14Comics <- cox.zph(coxmodel14Comics))
(res.zph14Crafts <- cox.zph(coxmodel14Crafts))
(res.zph14Dance <- cox.zph(coxmodel14Dance))
(res.zph14Design <- cox.zph(coxmodel14Design))
(res.zph14Fashion <- cox.zph(coxmodel14Fashion))
(res.zph14FilmandVideo <- cox.zph(coxmodel14FilmandVideo))
(res.zph14Food <- cox.zph(coxmodel14Food))
(res.zph14Games <- cox.zph(coxmodel14Games))
(res.zph14Journalism <- cox.zph(coxmodel14Journalism))
(res.zph14Music <- cox.zph(coxmodel14Music))
(res.zph14Photography <- cox.zph(coxmodel14Photography))
(res.zph14Publishing <- cox.zph(coxmodel14Publishing))
(res.zph14Technology <- cox.zph(coxmodel14Technology))
(res.zph14Theater <- cox.zph(coxmodel14Theater))
par(mfrow=c(1,1))
par(mfrow=c(3,3))
plot(res.zph14Art)
plot(res.zph14Comics)
plot(res.zph14Crafts)
plot(res.zph14Dance)
plot(res.zph14Design)
plot(res.zph14Fashion)
plot(res.zph14FilmandVideo)
plot(res.zph14Food)
plot(res.zph14Games)
plot(res.zph14Journalism)
plot(res.zph14Music)
plot(res.zph14Photography)
plot(res.zph14Publishing)
plot(res.zph14Technology)
plot(res.zph14Theater)