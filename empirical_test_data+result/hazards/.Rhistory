plot(kmfit14Art,lty = c('solid', 'dashed'), main= 'Art model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
surArt<-Surv(Art$survivalday,Art$state==1)
surComics<-Surv(Comics$survivalday,Comics$state==1)
surCrafts<-Surv(Crafts$survivalday,Crafts$state==1)
surDance<-Surv(Dance$survivalday,Dance$state==1)
surDesign<-Surv(Design$survivalday,Design$state==1)
surFashion<-Surv(Fashion$survivalday,Fashion$state==1)
surFilmandVideo<-Surv(FilmandVideo$survivalday,FilmandVideo$state==1)
surFood<-Surv(Food$survivalday,Food$state==1)
surGames<-Surv(Games$survivalday,Games$state==1)
surJournalism<-Surv(Journalism$survivalday,Journalism$state==1)
surMusic<-Surv(Music$survivalday,Music$state==1)
surPhotography<-Surv(Photography$survivalday,Photography$state==1)
surPublishing<-Surv(Publishing$survivalday,Publishing$state==1)
surTechnology<-Surv(Technology$survivalday,Technology$state==1)
surTheater<-Surv(Theater$survivalday,Theater$state==1)
kmfit14Art <- survfit(surArt~Art$FTDPR14_d)
kmfit14Comics <- survfit(surComics~Comics$FTDPR14_d)
kmfit14Crafts <- survfit(surCrafts~Crafts$FTDPR14_d)
kmfit14Dance <- survfit(surDance~Dance$FTDPR14_d)
kmfit14Design <- survfit(surDesign~Design$FTDPR14_d)
kmfit14Fashion <- survfit(surFashion~Fashion$FTDPR14_d)
kmfit14FilmandVideo <- survfit(surFilmandVideo~FilmandVideo$FTDPR14_d)
kmfit14Food <- survfit(surFood~Food$FTDPR14_d)
kmfit14Games <- survfit(surGames~Games$FTDPR14_d)
kmfit14Journalism <- survfit(surJournalism~Journalism$FTDPR14_d)
kmfit14Music <- survfit(surMusic~Music$FTDPR14_d)
kmfit14Photography <- survfit(surPhotography~Photography$FTDPR14_d)
kmfit14Publishing <- survfit(surPublishing~Publishing$FTDPR14_d)
kmfit14Technology <- survfit(surTechnology~Technology$FTDPR14_d)
kmfit14Theater <- survfit(surTheater~Theater$FTDPR14_d)
survdiff(Surv(survivalday,state)~FTDPR14_d, data=hazardsdata)
surdataset<-Surv(hazardsdata$survivalday,hazardsdata$state==1)
kmfit1 <- survfit(surdataset~1)
summary(kmfit1)
surArt<-Surv(Art$survivalday,Art$state==1)
kmfit14Art <- survfit(surArt~Art$FTDPR14_d)
surArt<-Surv(Art$survivalday,Art$state==1)
surComics<-Surv(Comics$survivalday,Comics$state==1)
surCrafts<-Surv(Crafts$survivalday,Crafts$state==1)
surDance<-Surv(Dance$survivalday,Dance$state==1)
surDesign<-Surv(Design$survivalday,Design$state==1)
surFashion<-Surv(Fashion$survivalday,Fashion$state==1)
surFilmandVideo<-Surv(FilmandVideo$survivalday,FilmandVideo$state==1)
surFood<-Surv(Food$survivalday,Food$state==1)
surGames<-Surv(Games$survivalday,Games$state==1)
surJournalism<-Surv(Journalism$survivalday,Journalism$state==1)
surMusic<-Surv(Music$survivalday,Music$state==1)
surPhotography<-Surv(Photography$survivalday,Photography$state==1)
surPublishing<-Surv(Publishing$survivalday,Publishing$state==1)
surTechnology<-Surv(Technology$survivalday,Technology$state==1)
surTheater<-Surv(Theater$survivalday,Theater$state==1)
kmfit14Art <- survfit(surArt~Art$FTDPR14_d)
kmfit14Comics <- survfit(surComics~Comics$FTDPR14_d)
kmfit14Crafts <- survfit(surCrafts~Crafts$FTDPR14_d)
kmfit14Dance <- survfit(surDance~Dance$FTDPR14_d)
kmfit14Design <- survfit(surDesign~Design$FTDPR14_d)
kmfit14Fashion <- survfit(surFashion~Fashion$FTDPR14_d)
kmfit14FilmandVideo <- survfit(surFilmandVideo~FilmandVideo$FTDPR14_d)
kmfit14Food <- survfit(surFood~Food$FTDPR14_d)
kmfit14Games <- survfit(surGames~Games$FTDPR14_d)
kmfit14Journalism <- survfit(surJournalism~Journalism$FTDPR14_d)
kmfit14Music <- survfit(surMusic~Music$FTDPR14_d)
kmfit14Photography <- survfit(surPhotography~Photography$FTDPR14_d)
kmfit14Publishing <- survfit(surPublishing~Publishing$FTDPR14_d)
kmfit14Technology <- survfit(surTechnology~Technology$FTDPR14_d)
kmfit14Theater <- survfit(surTheater~Theater$FTDPR14_d)
summary(kmfit14Theater)
plot(kmfit14Art,lty = c('solid', 'dashed'), main= 'Art model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Photography,lty = c('solid', 'dashed'), main= 'Photography model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Fashion,lty = c('solid', 'dashed'), main= 'Fashion model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Crafts,lty = c('solid', 'dashed'), main= 'Crafts model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Theater,lty = c('solid', 'dashed'), main= 'Theater model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Photography,lty = c('solid', 'dashed'), main= 'Photography model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
survdiff(Surv(survivalday,state)~FTDPR14_d, data=Art)
survdiff(Surv(survivalday,state)~FTDPR14_d+strata(update+ backercounts +commits+ log(goal) + hasavideo_d+friends), data=Art)
plot(kmfit14Art,lty = c('solid', 'dashed'), main= 'Art model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
summary(kmfit14Art)
(res.zph14Art <- cox.zph(coxmodel14Art))
coxmodel14Art <- coxph(surArt~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Art)
coxmodel14Art <- coxph(surArt~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Art)
coxmodel14Comics <- coxph(surComics~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Comics)
coxmodel14Crafts <- coxph(surCrafts~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Crafts)
coxmodel14Dance <- coxph(surDance~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Dance)
coxmodel14Design <- coxph(surDesign~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Design)
coxmodel14Fashion <- coxph(surFashion~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Fashion)
coxmodel14FilmandVideo <- coxph(surFilmandVideo~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=FilmandVideo)
coxmodel14Food <- coxph(surFood~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Food)
coxmodel14Games <- coxph(surGames~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Games)
coxmodel14Journalism <- coxph(surJournalism~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Journalism)
coxmodel14Music <- coxph(surMusic~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Music)
coxmodel14Photography <- coxph(surPhotography~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Photography)
coxmodel14Publishing <- coxph(surPublishing~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Publishing)
coxmodel14Technology <- coxph(surTechnology~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Technology)
coxmodel14Theater <- coxph(surTheater~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=Theater)
(res.zph14Art <- cox.zph(coxmodel14Art))
(res.zph14Art <- cox.zph(coxmodel14Art))
(res.zph14Comics <- cox.zph(coxmodel14Comics))
(res.zph14Crafts <- cox.zph(coxmodel14Crafts))
(res.zph14Dance <- cox.zph(coxmodel14Dance))
(res.zph14Design <- cox.zph(coxmodel14Design))
(res.zph14Fashion <- cox.zph(coxmodel14Fashion))
(res.zph14FilmandVideo <- cox.zph(coxmodel14FilmandVideo))
(res.zph14Food <- cox.zph(coxmodel14Food))
(res.zph14Games <- cox.zph(coxmodel14Games))
(res.zph14Journalism <- cox.zph(coxmodel14Journalism))
(res.zph14Music <- cox.zph(coxmodel14Music))
(res.zph14Photography <- cox.zph(coxmodel14Photography))
(res.zph14Publishing <- cox.zph(coxmodel14Publishing))
(res.zph14Technology <- cox.zph(coxmodel14Technology))
(res.zph14Theater <- cox.zph(coxmodel14Theater))
plot(res.zph14Art)
plot(kmfit14Art,lty = c('solid', 'dashed'), main= 'Art model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Comics,lty = c('solid', 'dashed'), main= 'Comics model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Crafts,lty = c('solid', 'dashed'), main= 'Crafts model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Dance,lty = c('solid', 'dashed'), main= 'Dance model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Design,lty = c('solid', 'dashed'), main= 'Design model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Fashion,lty = c('solid', 'dashed'), main= 'Fashion model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14FilmandVideo,lty = c('solid', 'dashed'), main= 'FilmandVideo model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Food,lty = c('solid', 'dashed'), main= 'Food model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Games,lty = c('solid', 'dashed'), main= 'Games model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Journalism,lty = c('solid', 'dashed'), main= 'Journalism model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Music,lty = c('solid', 'dashed'), main= 'Music model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Photography,lty = c('solid', 'dashed'), main= 'Photography model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Publishing,lty = c('solid', 'dashed'), main= 'Publishing model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Technology,lty = c('solid', 'dashed'), main= 'Technology model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Theater,lty = c('solid', 'dashed'), main= 'Theater model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
par(mfrow=c(3,5))
plot(kmfit14Art,lty = c('solid', 'dashed'), main= 'Art model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Comics,lty = c('solid', 'dashed'), main= 'Comics model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Crafts,lty = c('solid', 'dashed'), main= 'Crafts model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Dance,lty = c('solid', 'dashed'), main= 'Dance model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Design,lty = c('solid', 'dashed'), main= 'Design model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Fashion,lty = c('solid', 'dashed'), main= 'Fashion model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14FilmandVideo,lty = c('solid', 'dashed'), main= 'FilmandVideo model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Food,lty = c('solid', 'dashed'), main= 'Food model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Games,lty = c('solid', 'dashed'), main= 'Games model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Journalism,lty = c('solid', 'dashed'), main= 'Journalism model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Music,lty = c('solid', 'dashed'), main= 'Music model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Photography,lty = c('solid', 'dashed'), main= 'Photography model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Publishing,lty = c('solid', 'dashed'), main= 'Publishing model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Technology,lty = c('solid', 'dashed'), main= 'Technology model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Theater,lty = c('solid', 'dashed'), main= 'Theater model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
par(mfrow=c(3,5))
par(mfrow=c(3,5))
plot(kmfit14Art,lty = c('solid', 'dashed'), main= 'Art model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Comics,lty = c('solid', 'dashed'), main= 'Comics model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Crafts,lty = c('solid', 'dashed'), main= 'Crafts model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Dance,lty = c('solid', 'dashed'), main= 'Dance model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Design,lty = c('solid', 'dashed'), main= 'Design model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Fashion,lty = c('solid', 'dashed'), main= 'Fashion model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14FilmandVideo,lty = c('solid', 'dashed'), main= 'FilmandVideo model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Food,lty = c('solid', 'dashed'), main= 'Food model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Games,lty = c('solid', 'dashed'), main= 'Games model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Journalism,lty = c('solid', 'dashed'), main= 'Journalism model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Music,lty = c('solid', 'dashed'), main= 'Music model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Photography,lty = c('solid', 'dashed'), main= 'Photography model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Publishing,lty = c('solid', 'dashed'), main= 'Publishing model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Technology,lty = c('solid', 'dashed'), main= 'Technology model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Theater,lty = c('solid', 'dashed'), main= 'Theater model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(res.zph14withothervar)
(res.zph14withothervar <- cox.zph(coxmodel14withothervar))
coxmodel14withothervar <- coxph(surdataset~ FTDPR14_d +update+ backercounts +commits+ log(goal) + hasavideo_d+friends,data=hazardsdata)
(res.zph14withothervar <- cox.zph(coxmodel14withothervar))
plot(res.zph14withothervar)
par(mfrow=c(2,5))
plot(res.zph14withothervar)
par(mfrow=c(3,3))
plot(res.zph14withothervar)
hazardsdata <- read.csv("~/Dropbox/BitTorrentSync/kickstarter_dataset/data/empirical_test_data/hazards/hazardsdata.csv")
View(hazardsdata)
hazardsdata <- read.csv("~/Dropbox/BitTorrentSync/kickstarter_dataset/data/empirical_test_data/hazards/hazardsdata.csv")
View(hazardsdata)
surdataset<-Surv(hazardsdata$SURVIVALDAY,hazardsdata$state==1)
library(survival)
surdataset<-Surv(hazardsdata$SURVIVALDAY,hazardsdata$SUCCESS==1)
kmfit1 <- survfit(surdataset~1)
summary(kmfit1)
plot(kmfit1,xlab='survival time in days',ylab='survival probabilities')
plot(kmfit1,xlab='survival time in days',ylab='survival probabilities')
kmfit14 <- survfit(surdataset~hazardsdata$FTDPR14_d)
summary(kmfit14)
plot(kmfit14,lty = c('solid', 'dashed'), col=c('red','blue'),xlab='survival time in days',ylab='survival probabilities')
legend('bottomleft', c('FTDPR14_d=0','FTDPR14_d=1'), lty=c('solid','dashed'),col=c('red','blue'))
par(mfrow=c(3,5))
plot(kmfit14Art,lty = c('solid', 'dashed'), main= 'Art model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
legend('bottomleft', c('FTDPR14_d=0','FTDPR14_d=1'), lty=c('solid','dashed'),col=c('red','blue'))
plot(kmfit14Comics,lty = c('solid', 'dashed'), main= 'Comics model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Crafts,lty = c('solid', 'dashed'), main= 'Crafts model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Dance,lty = c('solid', 'dashed'), main= 'Dance model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Design,lty = c('solid', 'dashed'), main= 'Design model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Fashion,lty = c('solid', 'dashed'), main= 'Fashion model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14FilmandVideo,lty = c('solid', 'dashed'), main= 'FilmandVideo model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Food,lty = c('solid', 'dashed'), main= 'Food model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Games,lty = c('solid', 'dashed'), main= 'Games model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Journalism,lty = c('solid', 'dashed'), main= 'Journalism model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Music,lty = c('solid', 'dashed'), main= 'Music model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Photography,lty = c('solid', 'dashed'), main= 'Photography model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Publishing,lty = c('solid', 'dashed'), main= 'Publishing model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Technology,lty = c('solid', 'dashed'), main= 'Technology model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Theater,lty = c('solid', 'dashed'), main= 'Theater model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
Art<-subset(testdata,testdata['category_round']=='Art')
Comics<-subset(testdata,testdata['category_round']== 'Comics')
Crafts<-subset(testdata,testdata['category_round']== 'Crafts')
Dance<-subset(testdata,testdata['category_round']== 'Dance')
Design<-subset(testdata,testdata['category_round']== 'Design')
Fashion<-subset(testdata,testdata['category_round']== 'Fashion')
FilmandVideo<-subset(testdata,testdata['category_round']== 'Film&Video')
Food<-subset(testdata,testdata['category_round']== 'Food')
Games<-subset(testdata,testdata['category_round']== 'Games')
Journalism<-subset(testdata,testdata['category_round']== 'Journalism')
Music<-subset(testdata,testdata['category_round']== 'Music')
Photography<-subset(testdata,testdata['category_round']== 'Photography')
Publishing<-subset(testdata,testdata['category_round']== 'Publishing')
Technology<-subset(testdata,testdata['category_round']== 'Technology')
Theater<-subset(testdata,testdata['category_round']== 'Theater')
testdata<-hazardsdata
Art<-subset(testdata,testdata['category_round']=='Art')
Comics<-subset(testdata,testdata['category_round']== 'Comics')
Crafts<-subset(testdata,testdata['category_round']== 'Crafts')
Dance<-subset(testdata,testdata['category_round']== 'Dance')
Design<-subset(testdata,testdata['category_round']== 'Design')
Fashion<-subset(testdata,testdata['category_round']== 'Fashion')
FilmandVideo<-subset(testdata,testdata['category_round']== 'Film&Video')
Food<-subset(testdata,testdata['category_round']== 'Food')
Games<-subset(testdata,testdata['category_round']== 'Games')
Journalism<-subset(testdata,testdata['category_round']== 'Journalism')
Music<-subset(testdata,testdata['category_round']== 'Music')
Photography<-subset(testdata,testdata['category_round']== 'Photography')
Publishing<-subset(testdata,testdata['category_round']== 'Publishing')
Technology<-subset(testdata,testdata['category_round']== 'Technology')
Theater<-subset(testdata,testdata['category_round']== 'Theater')
Art<-subset(testdata,testdata['category']=='Art')
Comics<-subset(testdata,testdata['category']== 'Comics')
Crafts<-subset(testdata,testdata['category']== 'Crafts')
Dance<-subset(testdata,testdata['category']== 'Dance')
Design<-subset(testdata,testdata['category']== 'Design')
Fashion<-subset(testdata,testdata['category']== 'Fashion')
FilmandVideo<-subset(testdata,testdata['category']== 'Film&Video')
Food<-subset(testdata,testdata['category']== 'Food')
Games<-subset(testdata,testdata['category']== 'Games')
Journalism<-subset(testdata,testdata['category']== 'Journalism')
Music<-subset(testdata,testdata['category']== 'Music')
Photography<-subset(testdata,testdata['category']== 'Photography')
Publishing<-subset(testdata,testdata['category']== 'Publishing')
Technology<-subset(testdata,testdata['category']== 'Technology')
Theater<-subset(testdata,testdata['category']== 'Theater')
surArt<-Surv(Art$survivalday,Art$state==1)
surArt<-Surv(Art$SURVIVALDAY,Art$SUCCESS==1)
surArt<-Surv(Art$SURVIVALDAY,Art$SUCCESS==1)
surComics<-Surv(Comics$SURVIVALDAY,Comics$SUCCESS==1)
surCrafts<-Surv(Crafts$SURVIVALDAY,Crafts$SUCCESS==1)
surDance<-Surv(Dance$SURVIVALDAY,Dance$SUCCESS==1)
surDesign<-Surv(Design$SURVIVALDAY,Design$SUCCESS==1)
surFashion<-Surv(Fashion$SURVIVALDAY,Fashion$SUCCESS==1)
surFilmandVideo<-Surv(FilmandVideo$SURVIVALDAY,FilmandVideo$SUCCESS==1)
surFood<-Surv(Food$SURVIVALDAY,Food$SUCCESS==1)
surGames<-Surv(Games$SURVIVALDAY,Games$SUCCESS==1)
surJournalism<-Surv(Journalism$SURVIVALDAY,Journalism$SUCCESS==1)
surMusic<-Surv(Music$SURVIVALDAY,Music$SUCCESS==1)
surPhotography<-Surv(Photography$SURVIVALDAY,Photography$SUCCESS==1)
surPublishing<-Surv(Publishing$SURVIVALDAY,Publishing$SUCCESS==1)
surTechnology<-Surv(Technology$SURVIVALDAY,Technology$SUCCESS==1)
surTheater<-Surv(Theater$SURVIVALDAY,Theater$SUCCESS==1)
kmfit14Art <- survfit(surArt~Art$FTDPR14_d)
kmfit14Comics <- survfit(surComics~Comics$FTDPR14_d)
kmfit14Crafts <- survfit(surCrafts~Crafts$FTDPR14_d)
kmfit14Dance <- survfit(surDance~Dance$FTDPR14_d)
kmfit14Design <- survfit(surDesign~Design$FTDPR14_d)
kmfit14Fashion <- survfit(surFashion~Fashion$FTDPR14_d)
kmfit14FilmandVideo <- survfit(surFilmandVideo~FilmandVideo$FTDPR14_d)
kmfit14Food <- survfit(surFood~Food$FTDPR14_d)
kmfit14Games <- survfit(surGames~Games$FTDPR14_d)
kmfit14Journalism <- survfit(surJournalism~Journalism$FTDPR14_d)
kmfit14Music <- survfit(surMusic~Music$FTDPR14_d)
kmfit14Photography <- survfit(surPhotography~Photography$FTDPR14_d)
kmfit14Publishing <- survfit(surPublishing~Publishing$FTDPR14_d)
kmfit14Technology <- survfit(surTechnology~Technology$FTDPR14_d)
kmfit14Theater <- survfit(surTheater~Theater$FTDPR14_d)
summary(kmfit14Art)
plot(kmfit14Art,lty = c('solid', 'dashed'), main= 'Art model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
legend('bottomleft', c('FTDPR14_d=0','FTDPR14_d=1'), lty=c('solid','dashed'),col=c('red','blue'))
par(mfrow=c(3,5))
plot(kmfit14Art,lty = c('solid', 'dashed'), main= 'Art model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
legend('bottomleft', c('FTDPR14_d=0','FTDPR14_d=1'), lty=c('solid','dashed'),col=c('red','blue'))
plot(kmfit14Comics,lty = c('solid', 'dashed'), main= 'Comics model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Crafts,lty = c('solid', 'dashed'), main= 'Crafts model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Dance,lty = c('solid', 'dashed'), main= 'Dance model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Design,lty = c('solid', 'dashed'), main= 'Design model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Fashion,lty = c('solid', 'dashed'), main= 'Fashion model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14FilmandVideo,lty = c('solid', 'dashed'), main= 'FilmandVideo model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Food,lty = c('solid', 'dashed'), main= 'Food model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Games,lty = c('solid', 'dashed'), main= 'Games model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Journalism,lty = c('solid', 'dashed'), main= 'Journalism model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Music,lty = c('solid', 'dashed'), main= 'Music model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Photography,lty = c('solid', 'dashed'), main= 'Photography model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Publishing,lty = c('solid', 'dashed'), main= 'Publishing model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Technology,lty = c('solid', 'dashed'), main= 'Technology model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Theater,lty = c('solid', 'dashed'), main= 'Theater model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
par(mfrow=c(3,5))
plot(kmfit14Art,lty = c('solid', 'dashed'), main= 'Art model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
#legend('bottomleft', c('FTDPR14_d=0','FTDPR14_d=1'), lty=c('solid','dashed'),col=c('red','blue'))
plot(kmfit14Comics,lty = c('solid', 'dashed'), main= 'Comics model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Crafts,lty = c('solid', 'dashed'), main= 'Crafts model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Dance,lty = c('solid', 'dashed'), main= 'Dance model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Design,lty = c('solid', 'dashed'), main= 'Design model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Fashion,lty = c('solid', 'dashed'), main= 'Fashion model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14FilmandVideo,lty = c('solid', 'dashed'), main= 'FilmandVideo model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Food,lty = c('solid', 'dashed'), main= 'Food model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Games,lty = c('solid', 'dashed'), main= 'Games model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Journalism,lty = c('solid', 'dashed'), main= 'Journalism model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Music,lty = c('solid', 'dashed'), main= 'Music model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Photography,lty = c('solid', 'dashed'), main= 'Photography model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Publishing,lty = c('solid', 'dashed'), main= 'Publishing model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Technology,lty = c('solid', 'dashed'), main= 'Technology model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(kmfit14Theater,lty = c('solid', 'dashed'), main= 'Theater model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
plot(res.zph14Art)
(res.zph14Art <- cox.zph(coxmodel14Art))
coxmodel14Art <- coxph(surArt~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG(GOAL) + HASVIDEO+FRIENDS,data=Art)
coxmodel14Art <- coxph(surArt~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Art)
summary(coxmodel14Art)
(res.zph14Art <- cox.zph(coxmodel14Art))
plot(res.zph14Art)
par(mfrow=c(3,3))
plot(res.zph14Art)
par(mfrow=c(1,1))
plot(kmfit14Art,lty = c('solid', 'dashed'), main= 'Art model' ,col=c('red','blue'),xlab='survival time indays',ylab='survival probabilities')
par(mfrow=c(3,3))
plot(res.zph14Art)
summary(coxmodel14Art)
coxmodel14Art <- coxph(surArt~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Art)
coxmodel14Comics <- coxph(surComics~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Comics)
coxmodel14Crafts <- coxph(surCrafts~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Crafts)
coxmodel14Dance <- coxph(surDance~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Dance)
coxmodel14Design <- coxph(surDesign~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Design)
coxmodel14Fashion <- coxph(surFashion~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Fashion)
coxmodel14FilmandVideo <- coxph(surFilmandVideo~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=FilmandVideo)
coxmodel14Food <- coxph(surFood~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Food)
coxmodel14Games <- coxph(surGames~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Games)
coxmodel14Journalism <- coxph(surJournalism~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Journalism)
coxmodel14Music <- coxph(surMusic~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Music)
coxmodel14Photography <- coxph(surPhotography~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Photography)
coxmodel14Publishing <- coxph(surPublishing~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Publishing)
coxmodel14Technology <- coxph(surTechnology~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Technology)
coxmodel14Theater <- coxph(surTheater~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Theater)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Art)
coxmodel14Art <- coxph(surArt~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Art)
coxmodel14Comics <- coxph(surComics~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Comics)
coxmodel14Art <- coxph(surArt~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Art)
coxmodel14Comics <- coxph(surComics~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Comics)
coxmodel14Crafts <- coxph(surCrafts~ FTDPR14_d +UPDATES+ BACKERS +COMMENTS+ LOG.GOAL. + HASVIDEO+FRIENDS,data=Crafts)
summary(coxmodel14Comics)
summary(coxmodel14Theater)
summary(coxmodel14Games)
(res.zph14Comics <- cox.zph(coxmodel14Comics))
summary(coxmodel14Art)
sink("/Users/sn0wfree/Dropbox/BitTorrentSync/kickstarter_dataset/data/empirical_test_data/hazards/coxmodelcategoyrresult.txt")
summary(coxmodel14Art)
summary(coxmodel14Comics)
summary(coxmodel14Crafts)
summary(coxmodel14Dance)
summary(coxmodel14Design)
summary(coxmodel14Fashion)
summary(coxmodel14FilmandVideo)
summary(coxmodel14Food)
summary(coxmodel14Games)
summary(coxmodel14Journalism)
summary(coxmodel14Music)
summary(coxmodel14Photography)
summary(coxmodel14Publishing)
summary(coxmodel14Technology)
summary(coxmodel14Theater)
sink()
library(survival)
testdata<-hazardsdata
Art<-subset(testdata,testdata['category']=='Art')
Comics<-subset(testdata,testdata['category']== 'Comics')
Crafts<-subset(testdata,testdata['category']== 'Crafts')
Dance<-subset(testdata,testdata['category']== 'Dance')
Design<-subset(testdata,testdata['category']== 'Design')
Fashion<-subset(testdata,testdata['category']== 'Fashion')
FilmandVideo<-subset(testdata,testdata['category']== 'Film&Video')
Food<-subset(testdata,testdata['category']== 'Food')
Games<-subset(testdata,testdata['category']== 'Games')
Journalism<-subset(testdata,testdata['category']== 'Journalism')
Music<-subset(testdata,testdata['category']== 'Music')
Photography<-subset(testdata,testdata['category']== 'Photography')
Publishing<-subset(testdata,testdata['category']== 'Publishing')
Technology<-subset(testdata,testdata['category']== 'Technology')
Theater<-subset(testdata,testdata['category']== 'Theater')
category_group<-c(Art,Comics,Crafts,Dance,Design,Fashion,FilmandVideo,Food,Games,Journalism,Music,Photography,Publishing,Technology,Theater)
surArt<-Surv(Art$SURVIVALDAY,Art$SUCCESS==1)
surComics<-Surv(Comics$SURVIVALDAY,Comics$SUCCESS==1)
surCrafts<-Surv(Crafts$SURVIVALDAY,Crafts$SUCCESS==1)
surDance<-Surv(Dance$SURVIVALDAY,Dance$SUCCESS==1)
surDesign<-Surv(Design$SURVIVALDAY,Design$SUCCESS==1)
surFashion<-Surv(Fashion$SURVIVALDAY,Fashion$SUCCESS==1)
surFilmandVideo<-Surv(FilmandVideo$SURVIVALDAY,FilmandVideo$SUCCESS==1)
surFood<-Surv(Food$SURVIVALDAY,Food$SUCCESS==1)
surGames<-Surv(Games$SURVIVALDAY,Games$SUCCESS==1)
surJournalism<-Surv(Journalism$SURVIVALDAY,Journalism$SUCCESS==1)
surMusic<-Surv(Music$SURVIVALDAY,Music$SUCCESS==1)
surPhotography<-Surv(Photography$SURVIVALDAY,Photography$SUCCESS==1)
surPublishing<-Surv(Publishing$SURVIVALDAY,Publishing$SUCCESS==1)
surTechnology<-Surv(Technology$SURVIVALDAY,Technology$SUCCESS==1)
surTheater<-Surv(Theater$SURVIVALDAY,Theater$SUCCESS==1)
surdataset<-Surv(testdata$SURVIVALDAY,testdata$SUCCESS==1)
View(Food)
View(Food)
hazardsdata <- read.csv("~/Dropbox/BitTorrentSync/kickstarter_dataset/data/empirical_test_data/hazards/hazardsdata.csv")
View(hazardsdata)
testdata<-hazardsdata
Art<-subset(testdata,testdata['category']=='Art')
Comics<-subset(testdata,testdata['category']== 'Comics')
Crafts<-subset(testdata,testdata['category']== 'Crafts')
Dance<-subset(testdata,testdata['category']== 'Dance')
Design<-subset(testdata,testdata['category']== 'Design')
Fashion<-subset(testdata,testdata['category']== 'Fashion')
FilmandVideo<-subset(testdata,testdata['category']== 'Film&Video')
Food<-subset(testdata,testdata['category']== 'Food')
Games<-subset(testdata,testdata['category']== 'Games')
Journalism<-subset(testdata,testdata['category']== 'Journalism')
Music<-subset(testdata,testdata['category']== 'Music')
Photography<-subset(testdata,testdata['category']== 'Photography')
Publishing<-subset(testdata,testdata['category']== 'Publishing')
Technology<-subset(testdata,testdata['category']== 'Technology')
Theater<-subset(testdata,testdata['category']== 'Theater')
surArt<-Surv(Art$SURVIVALDAY,Art$SUCCESS==1)
surArt<-Surv(Art$SURVIVALDAY,Art$SUCCESS==1)
surComics<-Surv(Comics$SURVIVALDAY,Comics$SUCCESS==1)
surCrafts<-Surv(Crafts$SURVIVALDAY,Crafts$SUCCESS==1)
surDance<-Surv(Dance$SURVIVALDAY,Dance$SUCCESS==1)
surDesign<-Surv(Design$SURVIVALDAY,Design$SUCCESS==1)
surFashion<-Surv(Fashion$SURVIVALDAY,Fashion$SUCCESS==1)
surFilmandVideo<-Surv(FilmandVideo$SURVIVALDAY,FilmandVideo$SUCCESS==1)
surFood<-Surv(Food$SURVIVALDAY,Food$SUCCESS==1)
surGames<-Surv(Games$SURVIVALDAY,Games$SUCCESS==1)
surJournalism<-Surv(Journalism$SURVIVALDAY,Journalism$SUCCESS==1)
surMusic<-Surv(Music$SURVIVALDAY,Music$SUCCESS==1)
surPhotography<-Surv(Photography$SURVIVALDAY,Photography$SUCCESS==1)
surPublishing<-Surv(Publishing$SURVIVALDAY,Publishing$SUCCESS==1)
surTechnology<-Surv(Technology$SURVIVALDAY,Technology$SUCCESS==1)
surTheater<-Surv(Theater$SURVIVALDAY,Theater$SUCCESS==1)
kmfit14Art <- survfit(surArt~Art$FTDPR14_d)
summary(kmfit14Art)
kmfit14Art <- survfit(surArt~Art$FTDPR14_d)
kmfit14Comics <- survfit(surComics~Comics$FTDPR14_d)
kmfit14Crafts <- survfit(surCrafts~Crafts$FTDPR14_d)
kmfit14Dance <- survfit(surDance~Dance$FTDPR14_d)
kmfit14Design <- survfit(surDesign~Design$FTDPR14_d)
kmfit14Fashion <- survfit(surFashion~Fashion$FTDPR14_d)
kmfit14FilmandVideo <- survfit(surFilmandVideo~FilmandVideo$FTDPR14_d)
kmfit14Food <- survfit(surFood~Food$FTDPR14_d)
kmfit14Games <- survfit(surGames~Games$FTDPR14_d)
kmfit14Journalism <- survfit(surJournalism~Journalism$FTDPR14_d)
kmfit14Music <- survfit(surMusic~Music$FTDPR14_d)
kmfit14Photography <- survfit(surPhotography~Photography$FTDPR14_d)
kmfit14Publishing <- survfit(surPublishing~Publishing$FTDPR14_d)
kmfit14Technology <- survfit(surTechnology~Technology$FTDPR14_d)
kmfit14Theater <- survfit(surTheater~Theater$FTDPR14_d)
survdiff(Surv(SURVIVALDAY,SUCCESS)~FTDPR14_d, data=Art)
sink("/Users/sn0wfree/Dropbox/BitTorrentSync/kickstarter_dataset/data/empirical_test_data/hazards/coxsubsamplesurvivaldistribution.txt")
summary(kmfit14Art)
summary(kmfit14Comics)
summary(kmfit14Crafts)
summary(kmfit14Dance)
summary(kmfit14Design)
summary(kmfit14Fashion)
summary(kmfit14FilmandVideo)
summary(kmfit14Food)
summary(kmfit14Games)
summary(kmfit14Journalism)
summary(kmfit14Music)
summary(kmfit14Photography)
summary(kmfit14Publishing)
summary(kmfit14Technology)
summary(kmfit14Theater)
sink()
sink("/Users/sn0wfree/Dropbox/BitTorrentSync/kickstarter_dataset/data/empirical_test_data/hazards/coxsubsamplesurvivaldistribution.png")
summary(kmfit14Art)
summary(kmfit14Comics)
summary(kmfit14Crafts)
summary(kmfit14Dance)
summary(kmfit14Design)
summary(kmfit14Fashion)
summary(kmfit14FilmandVideo)
summary(kmfit14Food)
summary(kmfit14Games)
summary(kmfit14Journalism)
summary(kmfit14Music)
summary(kmfit14Photography)
summary(kmfit14Publishing)
summary(kmfit14Technology)
summary(kmfit14Theater)
sink()
sink("/Users/sn0wfree/Dropbox/BitTorrentSync/kickstarter_dataset/data/empirical_test_data/hazards/coxsubsamplesurvivaldistribution.csv")
summary(kmfit14Art)
summary(kmfit14Comics)
summary(kmfit14Crafts)
summary(kmfit14Dance)
summary(kmfit14Design)
summary(kmfit14Fashion)
summary(kmfit14FilmandVideo)
summary(kmfit14Food)
summary(kmfit14Games)
summary(kmfit14Journalism)
summary(kmfit14Music)
summary(kmfit14Photography)
summary(kmfit14Publishing)
summary(kmfit14Technology)
summary(kmfit14Theater)
sink()
